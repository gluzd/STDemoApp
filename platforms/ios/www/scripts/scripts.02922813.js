appConfig={},appConfig.servicesUrl="",appConfig.loggingEnabled=!1,appConfig.version="0.0.1",console.log("**** config.done"),ionic.Platform.ready(function(){console.log("Platform is ready!"),window.StatusBar&&StatusBar.styleDefault()});var PhoneGapInit=function(){this.boot=function(){angular.bootstrap(document,["STDemoApp"])},void 0!==window.phonegap?document.addEventListener("deviceready",function(){this.boot()}):(console.log("PhoneGap not found, booting Angular manually"),this.boot())};angular.element(document).ready(function(){new PhoneGapInit}),angular.module("STDemoApp.controllers",[]),angular.module("STDemoApp.services",[]),angular.module("STDemoApp.directives",[]),angular.module("STDemoApp",["ionic","ngTouch","STDemoApp.services","STDemoApp.controllers","STDemoApp.directives"]).run(["$rootScope","$window",function(a,b){console.log("**** app.run"),a.windowWidth=b.outerWidth,a.appVersion=appConfig.version,a.bookZoom=3,a.bookDarkMode=!1,a.allowRightMenu=!1,a.isTablet=a.windowWidth<768?!1:!1,angular.element(b).bind("resize",function(){a.windowWidth=b.outerWidth,a.$apply("windowWidth")})}]).config(["$stateProvider","$urlRouterProvider",function(a,b){a.state("home",{url:"/home",templateUrl:"views/home.html",controller:"HomeController"}).state("about",{url:"/about",templateUrl:"views/about.html"}).state("books",{url:"/books",templateUrl:"views/notifications.html",controller:"BooksController"}).state("book-detail",{url:"/book/:bookId",templateUrl:"views/notification-detail.html",controller:"BookDetailController"}).state("media-index",{url:"/media",templateUrl:"views/medias.html",controller:"MediaIndexController"}).state("media-detail",{url:"/media-show/:mediaId",templateUrl:"views/media-detail.html",controller:"MediaDetailController"}).state("places",{url:"/places",templateUrl:"views/places.html",controller:"PlacesController"}).state("place-detail",{url:"/place/:placeId",templateUrl:"views/place-detail.html",controller:"PlaceDetailController"}).state("options",{url:"/options",templateUrl:"views/options.html",controller:"OptionsController"}).state("credits",{url:"/credits",templateUrl:"views/credits.html"}),b.otherwise("/home")}]),angular.module("upe.services",["ngResource"]).factory("Profileslst",["$resource",function(a){return a("services/profiles/:profileid.json",{},{query:{method:"GET",params:{profileid:"profilelist"},isArray:!0}})}]);var WebSqlAdapter=new function(){this.getAllBooks=function(a){var b=[];try{db=openDatabase("siloappdb","1.0","Silo App DB",2e5)}catch(c){alert("Error processing SQL: "+c)}db.transaction(function(c){c.executeSql("CREATE TABLE IF NOT EXISTS books (id INTEGER PRIMARY KEY,title,description,updated,lang)"),c.executeSql("INSERT OR REPLACE INTO books (id, title, description, lang) VALUES (1,'Book title 1', 'description 1', 'en')"),c.executeSql("INSERT OR REPLACE INTO books (id, title, description, lang) VALUES (2,'Libro titolo 2', 'description 2', 'it')"),c.executeSql("INSERT OR REPLACE INTO books (id, title, description, lang) VALUES (3,'Libro titulo 3', 'description 3', 'es')"),c.executeSql("INSERT OR REPLACE INTO books (id, title, description, lang) VALUES (4,'Book title 4', 'description 4', 'en')");var d="SELECT * FROM books";c.executeSql(d,[],function(c,d){for(var e=d.rows.length,f=0;e>f;f+=1)b[f]=d.rows.item(f);d.rows.length>0?a(b):console.log("getAllBooks error 1: ")},function(a,b){console.log("getAllBooks error 2: "+b.message)})})},this.findBookById=function(a,b){try{db=openDatabase("siloappdb","1.0","Silo App DB",2e5)}catch(c){alert("Error processing SQL: "+c)}db.transaction(function(c){var d="SELECT * FROM books WHERE id=:id";c.executeSql(d,[a],function(a,c){b(1===c.rows.length?c.rows.item(0):null)},function(a,b){console.log("getBook error 1: "+b.message)})},function(a,b){console.log("getBook error 2: "+b)})}};angular.module("STDemoApp.services",[]).factory("BookService",["$http",function(a){var b=[];return{all:function(c){a.get("assets/data/notifications.json").success(function(a){b=a,c(a)})},get:function(a){return console.log("BookService get "+a),b[a-1]}}}]).factory("BookServiceSQL",function(){var a=[];return{all:function(b){WebSqlAdapter.getAllBooks(function(c){a=c,b(c)})},get:function(a,b){WebSqlAdapter.findBookById(a,function(a){b(a)})}}}).factory("MediaService",function(){var a=[{id:0,title:"Lena Team 1",description:"Lena Team Description"},{id:1,title:"March Creek",description:"March Creek Descriptio"},{id:2,title:"Alaghe NY",description:"Alaghe NY"},{id:3,title:"Cats1",description:"Cats1 Description"}];return{all:function(){return a},get:function(b){return a[b]}}}).factory("PlaceService",["$http",function(a){var b=[];return{getAllPlaces:function(c){a.get("assets/data/places.json").success(function(a){b=a,c(a)})},get:function(a){return b[a-1]}}}]),angular.module("STDemoApp.controllers").controller("AppController",["$scope","$rootScope","$window","$location","$ionicSideMenuDelegate",function(a,b,c,d,e){a.goToPage=function(a){b.isTablet||e.toggleLeft(!1),d.url("/"+a)},a.closeSideMenu=function(){e.close()},a.goBack=function(){c.history.back()},a.openLeftPanel=function(){e.toggleLeft()},a.openRightPanel=function(){e.toggleRight()}}]).controller("HomeController",["$scope",function(){}]).controller("OptionsController",["$scope","BookService",function(){}]).controller("PlacesController",["$scope","PlaceService",function(a,b){b.getAllPlaces(function(b){a.places=b}),a.clearFilter=function(){a.searchString=""}}]).controller("PlaceDetailController",["$scope","$stateParams","PlaceService","$ionicPlatform","$location",function(a,b,c,d){a.place=c.get(b.placeId),console.log("lat:"+a.place.lat+" lon: "+a.place.lon),a.whoiswhere=[],a.coordinates={lat:a.place.lat,lon:a.place.lon},d.ready(function(){navigator.geolocation.getCurrentPosition(function(b){a.position=b;var c=b.coords;a.gotoLocation(c.latitude,c.longitude),a.$apply()},function(a){console.log("Error retrieving position "+a.code+" "+a.message)}),a.gotoLocation=function(b,c){(a.lat!=b||a.lon!=c)&&(a.coordinates={lat:b,lon:c},a.$$phase||a.$apply("coordinates"))},a.whoiswhere=[{name:a.place.title,lat:a.coordinates.lat,lon:a.coordinates.lon}]})}]).controller("BooksController",["$scope","BookService",function(a,b){b.all(function(b){a.books=b,a.$apply()}),a.clearFilter=function(){a.searchString=""}}]).controller("BookDetailController",["$scope","$stateParams","BookService",function(a,b,c){c.get(b.bookId,function(b){a.book=b,a.$apply()})}]).controller("BookReadController",["$scope","$stateParams","BookService",function(a,b,c){c.get(b.bookId,function(b){a.book=b,a.$apply()})}]).controller("MediaIndexController",["$scope","MediaService",function(a,b){a.medias=b.all()}]).controller("MediaDetailController",["$scope","$stateParams","MediaService",function(a,b,c){a.media=c.get(b.mediaId)}]).controller("LocationController",["$scope","CordovaService",function(a,b){b.ready.then(function(){})}]),angular.module("STDemoApp.controllers").controller("BooksController",["$scope","BookService",function(a,b){b.all(function(b){a.books=b}),a.clearFilter=function(){a.searchString=""}}]).controller("BookDetailController",["$scope","$rootScope","$stateParams","BookService",function(a,b,c,d){b.allowRightMenu=!0,a.book=d.get(c.bookId);var e={1:"xsmall",2:"small",3:"normal",4:"large",5:"xlarge"};a.textsizeClass=e[b.bookZoom],b.bookDarkMode&&(a.stylemodeClass="dark-content"),a.changeStyle=function(){b.bookDarkMode=!b.bookDarkMode,a.stylemodeClass=b.bookDarkMode?"dark-content":""},a.zoomInText=function(){b.bookZoom>1&&(b.bookZoom-=1,a.textsizeClass=e[b.bookZoom],a.$broadcast("scroll.resize"))},a.zoomOutText=function(){b.bookZoom<5&&(b.bookZoom+=1,a.textsizeClass=e[b.bookZoom],a.$broadcast("scroll.resize"))},a.fullscreen=function(){alert("not yet ;)")},a.chapters=function(){a.sideMenuController.toggleRight()}}]),angular.module("STDemoApp.directives",[]).directive("appMap",["$window",function(a){return{restrict:"E",replace:!0,template:"<div></div>",scope:{center:"=",markers:"=",width:"@",height:"@",zoom:"@",mapTypeId:"@",panControl:"@",zoomControl:"@",scaleControl:"@"},link:function(b,c){function d(){console.log("map: start loading js gmaps");var b=a.document.createElement("script");b.type="text/javascript",b.src="http://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&callback=InitMapCb",a.document.body.appendChild(b)}function e(){console.log("map: create map start");var a={zoom:13,center:new google.maps.LatLng(47.55,7.59),mapTypeId:google.maps.MapTypeId.ROADMAP,panControl:!0,zoomControl:!0,mapTypeControl:!0,scaleControl:!1,streetViewControl:!1,navigationControl:!0,disableDefaultUI:!0,overviewMapControl:!0};i instanceof google.maps.Map||(console.log("map: create map now as not already available "),i=new google.maps.Map(c[0],a),google.maps.event.addDomListener(c[0],"mousedown",function(a){return a.preventDefault(),!1}),j=new google.maps.InfoWindow)}function f(a,b,c){var d="Name: "+b+"<br />Time: "+c;j.setContent(d),j.setPosition(a.position),j.open(i),google.maps.event.addListener(j,"closeclick",function(){j.close()})}function g(a,b,c){return function(){var d="http://maps.apple.com/?q="+b.lat+","+b.lon;i.setCenter(c),f(a,b.name,b.date,d)}}function h(){if(i&&b.markers){k=[];var a=b.markers;angular.isString(a)&&(a=b.$eval(b.markers));for(var c=0;c<a.length;c++){var d=a[c],e=new google.maps.LatLng(d.lat,d.lon),f=new google.maps.Marker({position:e,map:i,title:d.name});google.maps.event.addListener(f,"click",g(f,d,e)),k.push(f)}}}var i,j,k,l="InitMapCb";a[l]=function(){console.log("map: init callback"),e(),h()},a.google&&a.google.maps?(console.log("map: IS available - create only map now"),e()):(console.log("map: not available - load now gmap js"),d()),b.$watch("markers",function(){h()})}}}]);